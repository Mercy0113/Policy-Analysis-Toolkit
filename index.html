<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æ”¿ç­–åˆ†æå·¥å…·ç®±</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.1/dist/echarts.min.js"></script>
</head>

<body>
    <div class="container my-4">
        <h1 class="text-center">ğŸ§° æ”¿ç­–åˆ†æå·¥å…·ç®±</h1>

        <!-- ä¸Šä¼  PDF -->
        <div class="card my-3">
            <div class="card-body">
                <h5>ğŸ“‚ ä¸Šä¼ æ”¿ç­– PDF æ–‡ä»¶</h5>
                <input type="file" id="pdfUpload" class="form-control" accept="application/pdf">
                <button class="btn btn-primary mt-2" onclick="uploadPDF()">ä¸Šä¼ å¹¶è§£æ</button>
            </div>
        </div>

        <!-- æ”¿ç­–æ•°æ®åº“ -->
        <div class="card my-3">
            <div class="card-body">
                <h5>ğŸ“š æ”¿ç­–æ•°æ®åº“</h5>
                <input type="text" class="form-control" id="searchInput" placeholder="è¾“å…¥æ”¿ç­–å…³é”®è¯">
                <button class="btn btn-primary mt-2" onclick="searchPolicy()">æœç´¢</button>
                <div id="searchResults" class="list-group mt-2"></div>
            </div>
        </div>

        <!-- èˆ†æƒ…ç›‘æµ‹ -->
        <div class="card my-3">
            <div class="card-body">
                <h5>ğŸ” èˆ†æƒ…ç›‘æµ‹</h5>
                <input type="text" class="form-control" id="newKeyword" placeholder="è¾“å…¥å…³é”®è¯">
                <button class="btn btn-secondary mt-2" onclick="addKeyword()">æ·»åŠ å…³é”®è¯</button>
                <button class="btn btn-primary mt-2" onclick="startMonitoring()">å¯åŠ¨ç›‘æµ‹</button>
                <div id="keywordContainer" class="mt-2"></div>
                <div id="monitorStatus" class="alert alert-info mt-3" style="display: none;"></div>
            </div>
        </div>

        <!-- æ”¿ç­–åˆ†æ -->
        <div class="card my-3">
            <div class="card-body">
                <h5>ğŸ› ï¸ æ”¿ç­–åˆ†æ</h5>
                <textarea class="form-control" rows="3" id="policyText" placeholder="ç²˜è´´æ”¿ç­–å†…å®¹"></textarea>
                <button class="btn btn-primary mt-2" onclick="analyzePolicy()">åˆ†ææ”¿ç­–</button>
                <p class="mt-2" id="analysisResult"></p>
            </div>
        </div>

        <!-- æ—¶æ•ˆæé†’ -->
        <div class="card my-3">
            <div class="card-body">
                <h5>â° æ—¶æ•ˆæé†’</h5>
                <button class="btn btn-primary mt-2" onclick="showDeadlines()">åŠ è½½å³å°†åˆ°æœŸçš„æ”¿ç­–</button>
                <div id="deadlineList" class="mt-3"></div>
            </div>
        </div>

        <!-- æ•°æ®å¯è§†åŒ– -->
        <div class="card my-3">
            <div class="card-body">
                <h5>ğŸ“Š æ•°æ®å¯è§†åŒ–</h5>
                <div id="chart" style="height: 400px;"></div>
            </div>
        </div>
    </div>

    <script>
        function uploadPDF() {
            let file = document.getElementById('pdfUpload').files[0];
            if (!file) {
                alert("è¯·ä¸Šä¼  PDF æ–‡ä»¶ï¼");
                return;
            }
            let formData = new FormData();
            formData.append("file", file);

            fetch("/upload", { method: "POST", body: formData })
                .then(response => response.json())
                .then(data => alert("è§£ææˆåŠŸï¼š" + data.content))
                .catch(error => alert("è§£æå¤±è´¥ï¼š" + error));
        }

        function searchPolicy() {
            let query = document.getElementById('searchInput').value;
            document.getElementById('searchResults').innerHTML = `<div class="list-group-item">æ‰¾åˆ°æ”¿ç­–ï¼š${query}</div>`;
        }

        function addKeyword() {
            let keyword = document.getElementById('newKeyword').value.trim();
            if (keyword) {
                let tag = document.createElement('span');
                tag.className = 'badge bg-primary me-1';
                tag.textContent = keyword;
                document.getElementById('keywordContainer').appendChild(tag);
                document.getElementById('newKeyword').value = '';
            }
        }

        function startMonitoring() {
            let keywords = document.querySelectorAll('.badge');
            let keywordList = [];
            keywords.forEach(tag => keywordList.push(tag.textContent));
            if (keywordList.length > 0) {
                document.getElementById('monitorStatus').innerHTML = `ç›‘æµ‹ä¸­ï¼š${keywordList.join(', ')}`;
                document.getElementById('monitorStatus').style.display = 'block';
            }
        }

        function analyzePolicy() {
            let text = document.getElementById('policyText').value.trim();
            document.getElementById('analysisResult').textContent = text ? `åˆ†æç»“æœï¼šæ”¿ç­–å½±å“è¾ƒå¤§ã€‚` : `è¯·è¾“å…¥æ”¿ç­–å†…å®¹ï¼`;
        }

        function showDeadlines() {
            document.getElementById('deadlineList').innerHTML = `
                <div class="alert alert-warning">ğŸ“Œ "ç¢³ä¸­å’Œè¡ŒåŠ¨æ–¹æ¡ˆ" å‰©ä½™ 30 å¤©</div>
                <div class="alert alert-danger">ğŸ“Œ "æ•°å­—ç»æµåå››äº”è§„åˆ’" å‰©ä½™ 7 å¤©</div>
            `;
        }

        function initChart() {
            let chart = echarts.init(document.getElementById('chart'));
            let option = {
                title: { text: 'æ”¿ç­–è¶‹åŠ¿åˆ†æ' },
                tooltip: {},
                xAxis: { data: ['æ”¿ç­–A', 'æ”¿ç­–B', 'æ”¿ç­–C', 'æ”¿ç­–D', 'æ”¿ç­–E'] },
                yAxis: {},
                series: [{ type: 'bar', data: [5, 20, 36, 10, 10] }]
            };
            chart.setOption(option);
        }

        window.onload = initChart;
    </script>
</body>

</html>
